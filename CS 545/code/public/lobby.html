!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="Dashboard">
  <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
  <title>Oncampus</title>

  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Bootstrap core CSS -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!--external css-->
  <link href="lib/font-awesome/css/font-awesome.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="css/zabuto_calendar.css">
  <link rel="stylesheet" type="text/css" href="lib/gritter/css/jquery.gritter.css" />
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet">
  <link href="css/style-responsive.css" rel="stylesheet">
  <script src="lib/chart-master/Chart.js"></script>
  <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="https://kit.fontawesome.com/32b0047838.js" crossorigin="anonymous"></script>
    <script>
      $(function () {
        var socket = io();
        $('form').submit(function(e){
          e.preventDefault(); // prevents page reloading
          socket.emit('chat message', $('#m').val());
          $('#m').val('');
          return false;
        });
        socket.on('chat message', function(msg){
          $('#messages').append($('<li>').text(msg));
        });
      });
  </script>
    <style>
      #messages { list-style-type: none; margin: 0; padding: 0; }
      #messages li { padding: 5px 10px; }
      #messages li:nth-child(odd) { background: #eee; }
    </style>
    <style>
        /* Always set the map height explicitly to define the size of the div
         * element that contains the map. */
        #map {
          height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */
        html, body {
          height: 100%;
          margin: 0;
          padding: 0;
        }
    </style>
  
</head>

<body>
  <section id="container">
    <!-- **********************************************************************************************************************************************************
        TOP BAR CONTENT & NOTIFICATIONS
        *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header class="header black-bg">
      <div class="sidebar-toggle-box">
        <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
      </div>
      <!--logo start-->
      <a href="index.html" class="logo"><b>On<span>Campus</span></b></a>
      <!--logo end-->
      <div class="nav notify-row" id="top_menu">
        <!--  notification start -->
        <ul class="nav top-menu">
          <!-- settings start -->
          <li class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="index.html#">
              <i class="fa fa-tasks"></i>
              <span class="badge bg-theme">4</span>
              </a>
            <ul class="dropdown-menu extended tasks-bar">
              <div class="notify-arrow notify-arrow-green"></div>
              <li>
                <p class="green">You have 4 pending tasks</p>
              </li>
              <li>
                <a href="index.html#">
                  <div class="task-info">
                    <div class="desc">CS545 Final Project</div>
                    <div class="percent">90%</div>
                  </div>
                  <div class="progress progress-striped">
                    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%">
                      <span class="sr-only">90% Complete (success)</span>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a href="index.html#">
                  <div class="task-info">
                    <div class="desc">CS600 HW7</div>
                    <div class="percent">60%</div>
                  </div>
                  <div class="progress progress-striped">
                    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%">
                      <span class="sr-only">60% Complete (warning)</span>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a href="index.html#">
                  <div class="task-info">
                    <div class="desc">CS545 Worksheet3</div>
                    <div class="percent">80%</div>
                  </div>
                  <div class="progress progress-striped">
                    <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%">
                      <span class="sr-only">80% Complete</span>
                    </div>
                  </div>
                </a>
              </li>
              <li>
                <a href="index.html#">
                  <div class="task-info">
                    <div class="desc">CA Exam Grading</div>
                    <div class="percent">70%</div>
                  </div>
                  <div class="progress progress-striped">
                    <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width: 70%">
                      <span class="sr-only">70% Complete (Important)</span>
                    </div>
                  </div>
                </a>
              </li>
              <li class="external">
                <a href="#">See All Tasks</a>
              </li>
            </ul>
          </li>
          <!-- settings end -->
          <!-- inbox dropdown start-->
          <li id="header_inbox_bar" class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="index.html#">
              <i class="fa fa-envelope-o"></i>
              <span class="badge bg-theme">5</span>
              </a>
            <ul class="dropdown-menu extended inbox">
              <div class="notify-arrow notify-arrow-green"></div>
              <li>
                <p class="green">You have 5 new messages</p>
              </li>
              <li>
                <a href="index.html#">
                  <span class="photo"><img alt="avatar" src="img/ui-zac.jpg"></span>
                  <span class="subject">
                  <span class="from">Tianyi Wang</span>
                  <span class="time">Just now</span>
                  </span>
                  <span class="message">
                  Hi, could I meet you at library 1st floor?
                  </span>
                  </a>
              </li>
              <li>
                <a href="index.html#">
                  <span class="photo"><img alt="avatar" src="img/ui-divya.jpg"></span>
                  <span class="subject">
                  <span class="from">Huixiang Xu</span>
                  <span class="time">40 mins.</span>
                  </span>
                  <span class="message">
                  Hi, I need your help with this.
                  </span>
                  </a>
              </li>
              <li>
                <a href="index.html#">
                  <span class="photo"><img alt="avatar" src="img/ui-danro.jpg"></span>
                  <span class="subject">
                  <span class="from">Yuting Shao</span>
                  <span class="time">2 hrs.</span>
                  </span>
                  <span class="message">
                  I finished my part of CS545 Final_Project.
                  </span>
                  </a>
              </li>
              <li>
                <a href="index.html#">
                  <span class="photo"><img alt="avatar" src="img/ui-sherman.jpg"></span>
                  <span class="subject">
                  <span class="from">Huajie Xu</span>
                  <span class="time">4 hrs.</span>
                  </span>
                  <span class="message">
                  Please response me asap.
                  </span>
                  </a>
              </li>
              <li>
                <a href="index.html#">See all messages</a>
              </li>
            </ul>
          </li>
          <!-- inbox dropdown end -->
          <!-- notification dropdown start-->
          <li id="header_notification_bar" class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="index.html#">
              <i class="fa fa-bell-o"></i>
              <span class="badge bg-warning">2</span>
              </a>
            <ul class="dropdown-menu extended notification">
              <div class="notify-arrow notify-arrow-yellow"></div>
              <li>
                <p class="yellow">You have 2 events</p>
              </li>
                <li>
                <a href="index.html#">
                  <span class="label label-warning"><i class="fa fa-bell"></i></span>
                  CS600 Final Exam.
                  <span class="small italic">Due 9:59 pm.</span>
                  </a>
              </li>
              <li>
                <a href="index.html#">
                  <span class="label label-warning"><i class="fa fa-bell"></i></span>
                  CS545 Final Project.
                  <span class="small italic">Due 11:59 pm.</span>
                  </a>
              </li>

              <li>
                <a href="index.html#">See all notifications</a>
              </li>
            </ul>
          </li>
          <!-- notification dropdown end -->
        </ul>
        <!--  notification end -->
      </div>
      <div class="top-menu">
        <ul class="nav pull-right top-menu">
          <li><a class="logout" href="login.html">Logout</a></li>
        </ul>
      </div>
    </header>
    <!--header end-->
    
    
    
    <!-- **********************************************************************************************************************************************************
        MAIN SIDEBAR MENU
        *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <aside>
      <div id="sidebar" class="nav-collapse ">
        <!-- sidebar menu start-->
        <ul class="sidebar-menu" id="nav-accordion">
          <p class="centered"><a href="profile.html"><img src="img/ui-sam.jpg" class="img-circle" width="80"></a></p>
          <h5 class="centered">Yangyang Liu</h5>
          <li class="mt">
            <a href="index.html">
              <i class="fa fa-dashboard"></i>
              <span>Dashboard</span>
              </a>
          </li>
         
          <li class="sub-menu">
            <a href="javascript:;">
              <i class="fa fa-cogs"></i>
              <span>Components</span>
              </a>
            <ul class="sub">
              <li><a href="calendar.html">Calendar</a></li>
              <li><a href="todo_list.html">Todo List</a></li>
            </ul>
          </li>
          
                  <li class="sub-menu">
            <a class="active" href="javascript:;">
              <i class="fa fa-comments-o"></i>
              <span>Chat Room</span>
              </a>
            <ul class="sub">
              <li ><a href="chat_room.html">Chat</a></li>
              <li class="active"><a href="lobby.html">Group Chat</a></li>
            </ul>
          </li>
          <li>
            <a href="inbox.html">
              <i class="fa fa-envelope"></i>
              <span>Mail </span>
              <span class="label label-theme pull-right mail-info">2</span>
              </a>
          </li>
          <li>
            <a href="google_maps.html">
              <i class="fa fa-map-marker"></i>
              <span>Google Maps </span>
              </a>
          </li>
        </ul>
        <!-- sidebar menu end-->
      </div>
    </aside>
    <!--sidebar end-->
    
    
    
    <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->
    <!--main content start-->
    <section id="main-content">
      <section class="wrapper site-min-height">
        <!-- page start-->
 
         <div class="chat-room mt">
          <aside class="mid-side">
            <div class="chat-room-head">
              <h3>Chat</h3>
              <form action="#" class="pull-right position">
                <input type="text" placeholder="Search" class="form-control search-btn ">
              </form>
            </div>
            <div class="room-desk">
            <div class="room-box" id="map" style="height: 423px; ">
              <h4 class="pull-left">Map</h4>
            </div></div>
            
            <div class="room-desk">
              <h4 class="pull-left">Chat with: GroupCS545</h4>

              
              
             
              <div class="room-box">
                <div id="messages"></div>
              </div>
              <form action=""> 
                <div class="room-box">
                  <div class="chat-txt">
                    <input type="text" id="m" class="form-control">
                  </div>
                  <div class="btn-group hidden-sm hidden-xs">
                    <button type="button" class="btn btn-white"><i class="fa fa-meh-o"></i></button>
                    <button type="button" class="btn btn-white"><i class=" fa fa-paperclip"></i></button>
                  </div>
                  <button type="submit" class="btn btn-theme">Send</button>
                </div>
              </form>
            </div>
          </aside>
          <aside class="right-side">

            <div class="user-head">
              <a href="#" class="chat-tools btn-theme"><i class="fa fa-cog"></i> </a>
              <a href="#" class="chat-tools btn-theme03"><i class="fa fa-key"></i> </a>
            </div>
                        <div class="invite-row">
              <h4 class="pull-left">Groups</h4>
              <a href="#" class="btn btn-theme04 pull-right">+ Create</a>
            </div>
            
             <ul class="chat-available-user">
             <li>
                <a href="chat_room.html">
                  CS545Group  
                  </a>
              </li>

             <li>
                <a href="chat_room.html">
                  CS513Group  
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  CS584Group  
                  </a>
              </li>
            </ul>
            
           <div class="invite-row">
              <h4 class="pull-left">Team Members</h4>
              <a href="#" class="btn btn-theme04 pull-right">+ New</a>
            </div>
            
            <ul class="chat-available-user">
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-02.jpg" width="32">
                  Tianyi Wang
                  <span class="text-muted">15m</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-05.jpg" width="32">
                  Zhao Xiao
                  <span class="text-muted">1h:08m</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-07.jpg" width="32">
                  Huajie Xu
                  <span class="text-muted">1h:10m</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-08.jpg" width="32">
                  Yuting Shao
                  <span class="text-muted">3h:00m</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/ui-divya.jpg" width="32">
                  Huixiang Xu
                  <span class="text-muted">3h:30m</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-01.jpg" width="32">
                  Jierui Wang
                  <span class="text-muted">4h:22m</span>
                  </a>
              </li>
               <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-02.jpg" width="32">
                  Dong Wnag
                  <span class="text-muted">5h</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-05.jpg" width="32">
                 Zoe
                  <span class="text-muted">6h</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-07.jpg" width="32">
                  Aki
                  <span class="text-muted">7h</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-08.jpg" width="32">
                  Nick
                  <span class="text-muted">8h</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/ui-divya.jpg" width="32">
                  Jason
                  <span class="text-muted">9h</span>
                  </a>
              </li>
              <li>
                <a href="chat_room.html">
                  <img class="img-circle" src="img/friends/fr-01.jpg" width="32">
                  Nichal
                  <span class="text-muted">10h</span>
                  </a>
              </li>
            </ul>
            
            

          </aside>
        </div>
        <!-- page end-->
      </section>
      <!-- /wrapper -->
    </section>
    <!-- /MAIN CONTENT -->
    <!--main content end-->
    
    
    
     <!--footer start-->
    <footer class="site-footer">
      <div class="text-center">
        <p>
          &copy; 2019 <strong>Oncampus</strong>
        </p>
        <div class="credits">
          Stevens Institute Of Technology 
        </div>
        <a href="index.html#" class="go-top">
          <i class="fa fa-angle-up"></i>
          </a>
      </div>
    </footer>
    <!--footer end-->
    
    
    
    
    <!--footer end-->
  </section>
  <!-- js placed at the end of the document so the pages load faster -->
  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.min.js"></script>
  <script class="include" type="text/javascript" src="lib/jquery.dcjqaccordion.2.7.js"></script>
  <script src="lib/jquery.scrollTo.min.js"></script>
  <script src="lib/jquery.nicescroll.js" type="text/javascript"></script>
  <!--common script for all pages-->
  <script src="lib/common-scripts.js"></script>
  <!--script for this page-->
  <script>
            var socket = io();
            var map;
            var markers = [];
            var image = 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png';
            function setMapOnAll(map) {
              for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
              }
            }
            socket.on('point',function(data){
                var marker3 = new google.maps.Marker({
                  position: new google.maps.LatLng(data.lat, data.lng),
                  map: map,
                  title: data.title,
                  icon: image,
                  draggable: true,
                });
                if (!(markers.includes(marker3))) {
                  markers.push(marker3);
                }
            });
            ///不要动
            var timeout = setInterval(reload, 5000);  
            
            function reload () {
              map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 40.744882, lng: -74.025343},
                zoom: 18
              });
              map.addListener('click', function(e) {
                var inf = prompt("Please enter the event here: ", "Meet me");
                placeMarkerAndPanTo(e.latLng, map, inf);
              });
              map.addListener('rightclick', function(e) {
                setMapOnAll(null);
                markers = [];
              });
              for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
              }
              var centerControlDiv = document.createElement('div');
              var centerControl = new CenterControl(centerControlDiv, map);

              centerControlDiv.index = 1;
              map.controls[google.maps.ControlPosition.TOP_CENTER].push(centerControlDiv);
            }
        
        function CenterControl(controlDiv, map) {
        // Set CSS for the control border.
        var controlUI = document.createElement('div');
        controlUI.style.backgroundColor = '#fff';
        controlUI.style.border = '2px solid #fff';
        controlUI.style.borderRadius = '3px';
        controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
        controlUI.style.cursor = 'pointer';
        controlUI.style.marginBottom = '22px';
        controlUI.style.textAlign = 'center';
        controlUI.title = 'Click to recenter the map';
        controlDiv.appendChild(controlUI);

        // Set CSS for the control interior.
        var controlText = document.createElement('div');
        controlText.style.color = 'rgb(25,25,25)';
        controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
        controlText.style.fontSize = '16px';
        controlText.style.lineHeight = '38px';
        controlText.style.paddingLeft = '5px';
        controlText.style.paddingRight = '5px';
        controlText.innerHTML = 'View Event';
        controlUI.appendChild(controlText);

        // Setup the click event listeners: simply set the map to Chicago.
        controlUI.addEventListener('click', function() {
          var outputtext = 'Current Events: ' + '\n';
          for (var i = 0; i < markers.length; i++) {
            outputtext = outputtext + markers[i].title + '\n';
          }
          alert(outputtext);
        });
      }

            function initMap() {

              map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 40.744882, lng: -74.025343},
                zoom: 18
              });
              map.addListener('click', function(e) {
                var inf = prompt("Please enter the event here: ", "Meet me");
                placeMarkerAndPanTo(e.latLng, map, inf);
              });
              map.addListener('rightclick', function(e) {
                setMapOnAll(null);
                markers = [];
              });

              var centerControlDiv = document.createElement('div');
              var centerControl = new CenterControl(centerControlDiv, map);

              centerControlDiv.index = 1;
              map.controls[google.maps.ControlPosition.TOP_CENTER].push(centerControlDiv);
      
            };
            ///不要动
      
            function placeMarkerAndPanTo(latLng, map, inf) {
              var marker2 = new google.maps.Marker({
                position: latLng,
                map: map,
                title: inf,
                icon: image,
                draggable: true,
              });
              socket.emit('point',{lat: latLng.toJSON().lat, lng: latLng.toJSON().lng, title: inf});
              var cache = [];
              setMapOnAll(map);
              /*
              var temp = JSON.stringify({
                lat: marker2.getPosition().toJSON().lat,
                lng: marker2.getPosition().toJSON().lng,
                title: marker2.getTitle()
              })
              alert(temp);
              */
              
            }
          </script>
          <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDH-oqwnk2ksa_mvMXm5AaqEgjhQWHhuxM&callback=initMap"
          async defer></script>

</body>

</html>
